<!DOCTYPE html>
<html>
<head>
    <title>IELTS评分测试</title>
</head>
<body>
    <h1>IELTS评分系统测试</h1>
    
    <div>
        <h2>测试作文</h2>
        <textarea id="essayText" rows="10" cols="80">Technology has revolutionized education by making learning more accessible and interactive. Students can now access vast resources online, attend virtual classes, and collaborate with peers globally. However, excessive screen time and reduced face-to-face interaction may negatively impact social skills development. While digital tools enhance convenience, they cannot fully replace traditional teaching methods that foster critical thinking and personal connections. Therefore, a balanced approach combining technology and traditional education is optimal for comprehensive learning outcomes.</textarea>
        <br>
        <button onclick="testScoring()">测试评分</button>
        <button onclick="checkHealth()">检查API状态</button>
    </div>
    
    <div id="result"></div>
    
    <script>
        async function checkHealth() {
            try {
                const response = await fetch('/api/health');
                const data = await response.json();
                document.getElementById('result').innerHTML = '<h3>✅ API健康检查</h3><pre>' + JSON.stringify(data, null, 2) + '</pre>';
            } catch (error) {
                document.getElementById('result').innerHTML = '<h3>❌ API连接失败</h3><p>' + error.message + '</p>';
            }
        }
        
        async function testScoring() {
            const essay = {
                content: document.getElementById('essayText').value,
                wordCount: document.getElementById('essayText').value.split(/\s+/).filter(w => w.length > 0).length
            };
            
            try {
                const response = await fetch('/api/score-essay', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({
                        content: essay.content,
                        wordCount: essay.wordCount,
                        taskType: 'Task 2'
                    })
                });
                
                if (response.ok) {
                    const result = await response.json();
                    document.getElementById('result').innerHTML = '<h3>✅ 评分成功</h3><pre>' + JSON.stringify(result, null, 2) + '</pre>';
                } else {
                    const error = await response.text();
                    document.getElementById('result').innerHTML = '<h3>❌ 评分失败</h3><p>状态码: ' + response.status + '</p><p>错误: ' + error + '</p>';
                }
            } catch (error) {
                document.getElementById('result').innerHTML = '<h3>❌ 网络错误</h3><p>' + error.message + '</p>';
            }
        }
    </script>
</body>
</html>